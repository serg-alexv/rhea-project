{
  "timestamp": "2026-02-17T15:38:32Z",
  "passed": 51,
  "failed": 0,
  "tests": [
    {
      "test": "Monotonic seq",
      "status": "PASS",
      "detail": "seq 28 \u2192 29"
    },
    {
      "test": "Unique idempotency keys",
      "status": "PASS",
      "detail": ""
    },
    {
      "test": "Replay detection (drain)",
      "status": "PASS",
      "detail": "unique=2, total=2 \u2014 dedup works"
    },
    {
      "test": "Envelope version",
      "status": "PASS",
      "detail": "v=1"
    },
    {
      "test": "Timestamp format",
      "status": "PASS",
      "detail": "2026-02-17T15:38:32."
    },
    {
      "test": "Valid chain verifies",
      "status": "PASS",
      "detail": "chain valid"
    },
    {
      "test": "Detects payload tampering",
      "status": "PASS",
      "detail": "entry 2: event_hash mismatch (tampered)"
    },
    {
      "test": "Detects entry deletion",
      "status": "PASS",
      "detail": "entry 2: prev_hash mismatch (truncation/reorder)"
    },
    {
      "test": "Detects reordering",
      "status": "PASS",
      "detail": "entry 1: prev_hash mismatch (truncation/reorder)"
    },
    {
      "test": "Chain after truncation",
      "status": "PASS",
      "detail": "count=2 (truncation only detectable via external count)"
    },
    {
      "test": "Lease acquired",
      "status": "PASS",
      "detail": "token=1"
    },
    {
      "test": "Lease verifies",
      "status": "PASS",
      "detail": ""
    },
    {
      "test": "Rejects forged token",
      "status": "PASS",
      "detail": "forged=0, real=1"
    },
    {
      "test": "Rejects future token",
      "status": "PASS",
      "detail": "future=101, real=1"
    },
    {
      "test": "New lease > old",
      "status": "PASS",
      "detail": "1 \u2192 2"
    },
    {
      "test": "Old lease rejected",
      "status": "PASS",
      "detail": "old token no longer valid"
    },
    {
      "test": "New lease valid",
      "status": "PASS",
      "detail": ""
    },
    {
      "test": "Cross-agent rejected",
      "status": "PASS",
      "detail": "B2's token doesn't work for LEAD"
    },
    {
      "test": "Injection #1 stored safely",
      "status": "PASS",
      "detail": "attack type: IGNORE ALL PREVIOUS INSTRUCTIO..."
    },
    {
      "test": "Injection #2 stored safely",
      "status": "PASS",
      "detail": "attack type: {\"__proto__\": {\"admin\": true}}..."
    },
    {
      "test": "Injection #3 stored safely",
      "status": "PASS",
      "detail": "attack type: '; DROP TABLE messages; --..."
    },
    {
      "test": "Injection #4 stored safely",
      "status": "PASS",
      "detail": "attack type: <script>fetch('http://evil.com..."
    },
    {
      "test": "Injection #5 stored safely",
      "status": "PASS",
      "detail": "attack type: $(rm -rf /)..."
    },
    {
      "test": "Injection #6 stored safely",
      "status": "PASS",
      "detail": "attack type: `cat /etc/passwd`..."
    },
    {
      "test": "Injection #7 stored safely",
      "status": "PASS",
      "detail": "attack type: {{7*7}}..."
    },
    {
      "test": "Injection #8 stored safely",
      "status": "PASS",
      "detail": "attack type: ../../../etc/passwd..."
    },
    {
      "test": "Injection #9 stored safely",
      "status": "PASS",
      "detail": "attack type: \u0000\u0001\u0002..."
    },
    {
      "test": "All injections drain safely",
      "status": "PASS",
      "detail": "drained 9/9"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "IGNORE ALL PREVIOUS INSTRUCTIO"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "{\"__proto__\": {\"admin\": true}}"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "'; DROP TABLE messages; --"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "<script>fetch('http://evil.com"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "$(rm -rf /)"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "`cat /etc/passwd`"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "{{7*7}}"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "../../../etc/passwd"
    },
    {
      "test": "JSON roundtrip safe",
      "status": "PASS",
      "detail": "\u0000\u0001\u0002"
    },
    {
      "test": "Found secrets to test",
      "status": "PASS",
      "detail": "7 secret values"
    },
    {
      "test": "No secrets in logs",
      "status": "PASS",
      "detail": "checked 52 files, 7 secrets"
    },
    {
      "test": "Redact OPENAI_API_KEY",
      "status": "PASS",
      "detail": "redacted OK: key=[REDACTED_OPENAI_KEY] and more"
    },
    {
      "test": "Redact GEMINI_API_KEY",
      "status": "PASS",
      "detail": "redacted OK: key=[REDACTED_GEMINI_KEY] and more"
    },
    {
      "test": "Redact GEMINI_T1_API_KEY",
      "status": "PASS",
      "detail": "redacted OK: key=[REDACTED_GEMINI_KEY] and more"
    },
    {
      "test": "Fresh msg.send accepted",
      "status": "PASS",
      "detail": "no staleness limit"
    },
    {
      "test": "Old msg.send still deliverable",
      "status": "PASS",
      "detail": "no staleness limit"
    },
    {
      "test": "Stale effect.request rejected",
      "status": "PASS",
      "detail": "TTL exceeded (193505912s > 86400s)"
    },
    {
      "test": "Stale push.now rejected",
      "status": "PASS",
      "detail": "TTL exceeded (193505912s > 86400s)"
    },
    {
      "test": "Unknown type defaults safe",
      "status": "PASS",
      "detail": "no staleness limit"
    },
    {
      "test": "Traversal blocked: ../../../etc/passwd",
      "status": "PASS",
      "detail": "path=/var/folders/98/kzggkt892nnbmfbwtlq05jlh0000gn/T/tmp27idaary/leases/../../../etc/passwd.json"
    },
    {
      "test": "Traversal blocked: ..%2F..%2Fetc%2Fpasswd",
      "status": "PASS",
      "detail": "path=/var/folders/98/kzggkt892nnbmfbwtlq05jlh0000gn/T/tmp27idaary/leases/..%2F..%2Fetc%2Fpasswd.json"
    },
    {
      "test": "Traversal blocked: LEAD/../../secrets",
      "status": "PASS",
      "detail": "path=/var/folders/98/kzggkt892nnbmfbwtlq05jlh0000gn/T/tmp27idaary/leases/LEAD/../../secrets.json"
    },
    {
      "test": "Traversal blocked: LEAD\u0000.json",
      "status": "PASS",
      "detail": "path=/var/folders/98/kzggkt892nnbmfbwtlq05jlh0000gn/T/tmp27idaary/leases/LEAD\u0000.json.json"
    }
  ]
}