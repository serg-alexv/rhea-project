# Rhea — API Contracts

> Defines interfaces between components. No implementation yet — contracts only.

## 1. Bridge API (rhea_bridge.py)

### ask_default(prompt) → str
Sends prompt to cheap-tier model. Returns response text.

### ask_tier(prompt, tier) → str
Sends prompt to specified tier. Tier: "cheap" | "balanced" | "expensive" | "reasoning".

### tribunal(prompt, models=None, n=3) → dict
Runs prompt through n models, returns:
```json
{
  "responses": [{"model": "...", "response": "..."}],
  "consensus": "synthesized answer",
  "agreement_score": 0.85
}
```

## 2. State API (future — LangGraph)

### GET /state → RheaState
Returns current state vector.
```json
{
  "energy": 0.7,
  "mood": 0.6,
  "cognitive_load": 0.4,
  "sleep_debt": 1.5,
  "obligations": [...],
  "recovery": 0.8,
  "discomfort_level": "comfort",
  "current_D": 62.7,
  "current_agent": "router"
}
```

### POST /action → ActionResult
Sends user action to the graph. Returns result after agent processing.

## 3. Metrics API (future)

### GET /metrics → MemoryMetrics
Returns contents of `metrics/memory_metrics.json`.

### GET /metrics/health → HealthCheck
```json
{
  "benchmark_score": "70/71",
  "benchmark_pct": 98,
  "discomfort_level": "comfort",
  "current_D": 62.7,
  "last_benchmark_run": "2026-02-14T07:00:00Z"
}
```

## 4. Eval API (future)

### POST /eval/run → EvalResult
Runs a specific eval task.
```json
{
  "task_id": "eval-001-memory-recall",
  "score": 0.95,
  "details": {...},
  "timestamp": "2026-02-14T07:00:00Z"
}
```

## 5. PWA ↔ Backend Contract

The PWA reads from repo files directly (or via lightweight API).
No direct imports from `src/` into `ui/`.

| PWA View | Data Source | Format |
|----------|------------|--------|
| Dashboard | metrics/memory_metrics.json | JSON |
| Episode Explorer | .entire/snapshots/*.json | JSON |
| Agent Graph | langgraph/graph.py (future) | Python → JSON export |
| Schedule | Generated by Chronos agent | JSON |
| Task/Roadmap | data/challenging_tasks.yaml + docs/ROADMAP.md | YAML + Markdown |

## Notes

- All APIs are internal (no public endpoints yet)
- Authentication: not needed until multi-user support
- Rate limiting: handled by tier routing in bridge
- Versioning: semver on API contracts, tracked in this doc
